APPS  = apps
REBAR = ./rebar
MAKE  = make

.PHONY: compile rel get-deps 

all: compile

compile: get-deps
	@$(REBAR) compile

get-deps:
	@$(REBAR) get-deps
	@$(REBAR) check-deps

clean:
	@$(REBAR) clean
	rm -f erl_crash.dump

realclean: clean
	@$(REBAR) delete-deps

test:
	@$(REBAR) skip_deps=true eunit

doc:
	$(REBAR) skip_deps=true doc
	for app in $(APPS); do \
		cp -R apps/$${app}/doc doc/$${app}; \
	done;

dev:
	@PARIS_RUN_MODE="production" $(MAKE) run-dev
	
run-dev:
	erl -pa ebin include apps/*/ebin apps/*/include deps/*/ebin deps/*/include -config config/totoapp.config

analyze: checkplt
	@$(REBAR) skip_deps=true dialyze

buildplt:
	@$(REBAR) skip_deps=true build-plt

checkplt: buildplt
	@$(REBAR) skip_deps=true check-plt
